# 공통 모듈: 개념 충돌 해결

> 이 파일은 코드 생성/변경, 설계서 생성/수정을 수행하는 `/wf:*` 명령어에서 참조하는 공통 모듈입니다.

---

## 개념 충돌 유형

워크플로우 실행 중 다음과 같은 개념 충돌이 발생할 수 있습니다.

| 유형 | 충돌 상황 | 예시 |
|------|----------|------|
| **Type A** | 코드 vs 설계서 불일치 | 구현된 코드가 설계 문서와 다른 경우 |
| **Type B** | 설계 문서 간 충돌 | 기본설계(010)와 상세설계(020) 내용이 다른 경우 |
| **Type C** | 설계서 vs 기존 코드베이스 | 새 설계가 기존 코드 패턴/구조와 충돌하는 경우 |

---

## 충돌 해결 원칙

### 1. 기본 원칙

```
모든 수정 중 개념 충돌 발생 시 → 설계 문서를 따름
설계 문서 간 충돌 시 → 사용자에게 확인 요청
```

### 2. 유형별 해결 방법

| 유형 | 해결 방법 | 행동 |
|------|----------|------|
| **Type A** | 설계서 우선 | 설계 문서 기준으로 코드 수정 |
| **Type B** | 사용자 확인 | AskUserQuestion으로 어느 설계를 따를지 확인 |
| **Type C** | 설계서 우선 | 설계 문서 기준으로 구현, 기존 패턴 조정 |

---

## 설계 문서 우선순위

충돌 해결 시 설계 문서 참조 우선순위:

```
1순위: 상세설계 (020-detail-design.md)
2순위: 기본설계 (010-basic-design.md)
3순위: 화면설계 (011-ui-design.md)
```

> **참고**: 상위 번호 문서가 하위 번호 문서보다 구체적이므로 우선

---

## 충돌 해결 프로세스

### 1. 충돌 감지

작업 수행 전 다음을 확인:
- 기존 코드와 설계서 내용 비교
- 여러 설계 문서 간 일관성 검토
- 설계서와 기존 코드베이스 패턴 비교

### 2. 충돌 유형 식별

```
충돌 감지 시:
├── 코드 vs 설계서? → Type A
├── 설계서 vs 설계서? → Type B
└── 설계서 vs 코드베이스? → Type C
```

### 3. 해결 실행

**Type A, C (설계서 우선)**:
```
1. 설계 문서 내용 확인
2. 설계 문서 기준으로 수정 진행
3. 수정 내용 기록 (구현 보고서 또는 변경 이력)
```

**Type B (사용자 확인)**:
```
1. 충돌 내용 정리
2. AskUserQuestion으로 사용자에게 확인 요청
   - 기본설계 내용: [내용 요약]
   - 상세설계 내용: [내용 요약]
   - 어느 설계를 따를까요?
3. 사용자 선택에 따라 진행
4. 선택되지 않은 설계 문서 업데이트 (일관성 유지)
```

---

## 충돌 보고 형식

충돌 발견 시 다음 형식으로 보고:

```
[CONFLICT] 개념 충돌 감지

유형: Type A/B/C
위치: {파일 또는 설계 문서}
내용:
  - 설계서: {설계 내용}
  - 현재 상태: {코드/다른 설계 내용}
해결: {설계서 우선 적용 / 사용자 확인 필요}
```

---

## 적용 대상 명령어

이 규칙이 적용되는 워크플로우 명령어:

| 분류 | 명령어 | 적용 이유 |
|------|--------|----------|
| 설계서 생성/변경 | `/wf:start` | 기본설계 문서 생성 |
| | `/wf:draft` | 상세설계 문서 생성 |
| | `/wf:ui` | 화면설계 문서 생성 |
| | `/wf:apply` | 리뷰 내용 설계서 반영 |
| 코드 생성/변경 | `/wf:build` | 코드 구현 |
| | `/wf:patch` | 코드 리뷰 반영 |
| | `/wf:fix` | 결함 수정 |
| | `/wf:skip` | 설계 생략 후 구현 |
| 보고서 생성 | `/wf:done` | 매뉴얼 작성 |

---

<!--
jjiban 프로젝트 - Workflow Common Module
Module: wf-conflict-resolution
Version: 1.0
author: 장종익

Changes (v1.0):
- 초기 버전
- 개념 충돌 유형 정의 (Type A, B, C)
- 충돌 해결 원칙 및 프로세스 정의
- 설계 문서 우선순위 정의
-->
