# TSK-03-03 - 실시간 자동 갱신 사용자 매뉴얼

## 1. 개요

### 1.1 기능 소개

실시간 자동 갱신 기능은 orchay 웹 모니터링 UI에서 다음 영역을 5초마다 자동으로 갱신합니다:

- **Worker 상태 바**: Worker들의 현재 상태 (idle, busy, error 등)
- **전체 진행률**: 완료된 Task 수 / 전체 Task 수 (백분율)
- **WBS 트리**: Task 상태 변경 반영
- **Task 상세**: 선택된 Task의 최신 정보

### 1.2 대상 사용자

| 사용자 유형 | 주요 사용 목적 |
|------------|---------------|
| 개발자 | Worker 작업 상태 실시간 모니터링 |
| PM/관리자 | 전체 프로젝트 진행률 확인 |
| 스케줄러 운영자 | Task 분배 및 오류 감지 |

---

## 2. 시작하기

### 2.1 사전 요구사항

- orchay 스케줄러가 실행 중이어야 함
- 웹서버 활성화 필요 (`--web` 또는 `--web-only` 옵션)

### 2.2 접근 방법

1. orchay 실행 시 웹서버 옵션 사용:
   ```bash
   # TUI + 웹서버 동시 실행
   orchay myproject --web

   # 웹서버만 실행
   orchay myproject --web-only --port 8080
   ```

2. 브라우저에서 접속:
   ```
   http://localhost:8080
   ```

---

## 3. 사용 방법

### 3.1 기본 사용법

**자동 갱신은 별도 설정 없이 기본 활성화됩니다.**

페이지 접속 시:
1. Worker 상태 바가 자동으로 로드됩니다
2. WBS 트리가 자동으로 로드됩니다
3. 5초마다 모든 영역이 갱신됩니다

### 3.2 상세 기능

#### 3.2.1 진행률 표시

Worker 상태 바 우측에 전체 진행률이 표시됩니다:

```
Workers: 🟢W1 🟡W2     Progress: ████░░░░░░ 4/10 (40%)
```

- 프로그레스 바: 시각적 진행 상태
- 숫자: 완료 Task 수 / 전체 Task 수
- 백분율: 진행률 (%)

#### 3.2.2 Task 상세 자동 갱신

1. WBS 트리에서 Task 클릭
2. 우측 상세 패널에 정보 표시
3. **선택된 Task는 5초마다 자동 갱신**

> 💡 Task를 선택하지 않으면 상세 영역은 갱신되지 않습니다 (불필요한 요청 방지)

#### 3.2.3 깜빡임 최소화

HTMX settle 시간(100ms)이 적용되어 갱신 시 화면 깜빡임이 최소화됩니다.

### 3.3 인터랙션

| 동작 | 결과 |
|------|------|
| 페이지 접속 | 모든 영역 초기 로드 |
| Task 클릭 | 상세 표시 + 자동 갱신 시작 |
| 다른 Task 클릭 | 상세 전환 + 갱신 대상 변경 |
| 5초 대기 | 자동 갱신 발생 |

---

## 4. FAQ

### Q1: 갱신 주기를 변경할 수 있나요?
**A**: 현재 버전에서는 5초로 고정되어 있습니다. 향후 설정 가능하도록 개선 예정입니다.

### Q2: 네트워크가 끊기면 어떻게 되나요?
**A**: 화면에 "네트워크 연결 실패" 토스트 메시지가 표시되고, 다음 갱신 주기에 자동으로 재시도합니다.

### Q3: 선택 상태가 갱신 후 초기화되나요?
**A**: 아니요, localStorage에 상태가 저장되어 갱신 후에도 유지됩니다.

### Q4: 서버가 재시작되면 어떻게 되나요?
**A**: 서버 재시작 시 브라우저는 자동으로 재연결을 시도합니다. 오류 메시지 표시 후 복구됩니다.

---

## 5. 문제 해결

### 5.1 갱신이 되지 않는 경우

**증상**: 5초가 지나도 데이터가 갱신되지 않음

**해결 방법**:
1. 브라우저 개발자 도구 콘솔 확인
2. 네트워크 탭에서 요청 상태 확인
3. 페이지 새로고침 (F5)

### 5.2 "연결 오류" 메시지가 계속 표시되는 경우

**증상**: 빨간색 토스트 메시지가 반복적으로 표시됨

**해결 방법**:
1. orchay 서버 실행 상태 확인
2. 방화벽/네트워크 설정 확인
3. 브라우저 캐시 삭제 후 재시도

### 5.3 진행률이 표시되지 않는 경우

**증상**: "Progress:" 영역이 비어 있거나 NaN 표시

**해결 방법**:
1. WBS 파일에 Task가 정의되어 있는지 확인
2. 서버 로그 확인
3. `/api/workers` API 직접 호출하여 응답 확인

---

## 6. 참고 자료

### 6.1 관련 문서

| 문서 | 경로 |
|------|------|
| 설계서 | `.orchay/projects/orchay_web/tasks/TSK-03-03/010-design.md` |
| 테스트 명세서 | `.orchay/projects/orchay_web/tasks/TSK-03-03/026-test-specification.md` |
| 구현 보고서 | `.orchay/projects/orchay_web/tasks/TSK-03-03/030-implementation.md` |

### 6.2 API 엔드포인트

| 엔드포인트 | 설명 | 갱신 주기 |
|-----------|------|----------|
| `/api/workers` | Worker 상태 + 진행률 | 5초 |
| `/api/tree` | WBS 트리 | 5초 |
| `/api/detail/{id}` | Task 상세 | 5초 (선택 시) |

### 6.3 기술 스펙

- HTMX 2.0: 자동 갱신 (`hx-trigger="every 5s"`)
- JavaScript: Task Detail 갱신 (`setInterval`)
- Tailwind CSS: UI 스타일링

---

## 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0.0 | 2025-12-28 | Claude | 최초 작성 |
