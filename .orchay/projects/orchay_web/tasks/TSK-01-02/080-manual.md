# TSK-01-02 - Jinja2 템플릿 기본 구조 사용자 매뉴얼

## 문서 정보

| 항목 | 내용 |
|------|------|
| Task ID | TSK-01-02 |
| 문서 버전 | 1.0 |
| 작성일 | 2025-12-28 |
| 대상 사용자 | orchay 웹 UI 사용자, 개발자 |

---

## 1. 개요

### 1.1 기능 소개

본 Task에서 구현된 Jinja2 템플릿 기본 구조는 orchay 스케줄러의 웹 모니터링 UI의 기반이 됩니다. 다크테마 기반의 2열 레이아웃으로 구성되어 있으며, HTMX를 통한 동적 콘텐츠 갱신을 지원합니다.

### 1.2 대상 사용자

- **개발자**: orchay 스케줄러를 사용하여 작업을 모니터링하는 사용자
- **프로젝트 관리자**: WBS 진행률을 브라우저에서 확인하려는 사용자

### 1.3 주요 기능

| 기능 | 설명 |
|------|------|
| 다크테마 UI | 눈의 피로를 줄이는 어두운 배경 |
| 2열 레이아웃 | 트리 뷰와 상세 정보를 동시에 확인 |
| 자동 갱신 | 5초마다 Worker 상태 및 트리 자동 업데이트 |
| CDN 기반 스타일 | 빌드 도구 없이 Tailwind CSS 사용 |

---

## 2. 시작하기

### 2.1 사전 요구사항

- Python 3.10 이상
- orchay 패키지 설치 완료
- 네트워크 연결 (CDN 로드 필요)

### 2.2 웹 서버 실행

```bash
# 웹 서버 + TUI 동시 실행
python -m orchay {project} --web

# 웹 서버만 실행
python -m orchay {project} --web-only

# 포트 지정 (기본 8080)
python -m orchay {project} --web --port 9000
```

### 2.3 접속 방법

웹 서버 실행 후 브라우저에서 다음 주소로 접속합니다:

```
http://localhost:8080
```

---

## 3. 사용 방법

### 3.1 화면 구성

```
┌─────────────────────────────────────────────────────────────┐
│  orchay - {project_name}                      [MODE: quick] │  ← 헤더
├─────────────────────────────────────────────────────────────┤
│  Workers: 🟢 idle  🟡 busy  🟡 busy     Progress: ████░ 75% │  ← Worker 바
├───────────────────────────────┬─────────────────────────────┤
│  WBS Tree (좌측 50%)          │  Task Detail (우측 50%)     │
│                               │                             │
│  트리 구조로 Task 표시        │  선택한 Task 상세 정보      │
│                               │                             │
└───────────────────────────────┴─────────────────────────────┘
```

### 3.2 영역별 설명

| 영역 | 설명 | 갱신 주기 |
|------|------|----------|
| 헤더 | 프로젝트명과 실행 모드 표시 | 고정 |
| Worker 바 | 각 Worker의 상태(idle/busy/error)와 전체 진행률 | 5초 |
| WBS Tree | 계층적 Task 목록, 클릭으로 상세 확인 | 5초 |
| Task Detail | 선택한 Task의 상세 정보 | Task 선택 시 |

### 3.3 기본 사용법

1. **페이지 접속**: 브라우저에서 `http://localhost:8080` 접속
2. **트리 확인**: 좌측 WBS Tree에서 Task 목록 확인
3. **Task 선택**: Task를 클릭하면 우측에 상세 정보 표시
4. **자동 갱신**: 5초마다 상태가 자동으로 업데이트됨

---

## 4. 상세 기능

### 4.1 다크테마

모든 페이지에 다크테마가 기본 적용됩니다:

- 배경색: `#111827` (gray-900)
- 텍스트: `#f3f4f6` (gray-100)
- 테두리: `#374151` (gray-700)

### 4.2 HTMX 자동 갱신

페이지 새로고침 없이 콘텐츠가 자동으로 갱신됩니다:

- **갱신 주기**: 5초
- **갱신 대상**: Worker 상태 바, WBS 트리
- **동작 방식**: HTMX의 `hx-trigger="every 5s"` 속성 사용

### 4.3 반응형 레이아웃

| 화면 크기 | 레이아웃 |
|----------|---------|
| 1024px 이상 | 2열 (50% / 50%) |
| 768-1023px | 2열 (40% / 60%) |
| 767px 이하 | 기본 2열 유지 |

---

## 5. FAQ

### Q1. 페이지가 스타일 없이 표시됩니다

**원인**: CDN 연결 실패

**해결 방법**:
1. 네트워크 연결 상태 확인
2. 방화벽에서 cdn.tailwindcss.com, unpkg.com 허용
3. 페이지 새로고침 (F5)

### Q2. 자동 갱신이 동작하지 않습니다

**원인**: HTMX 로드 실패

**해결 방법**:
1. 개발자 도구(F12) > 콘솔에서 에러 확인
2. unpkg.com 접속 가능 여부 확인
3. 페이지 새로고침

### Q3. Task를 클릭해도 상세 정보가 표시되지 않습니다

**원인**: API 응답 오류

**해결 방법**:
1. 서버 콘솔에서 에러 메시지 확인
2. `/api/detail/{task_id}` 엔드포인트 직접 호출하여 확인

---

## 6. 문제 해결

### 6.1 서버 시작 실패

```
Error: Address already in use
```

**해결**: 다른 포트 사용

```bash
python -m orchay {project} --web --port 9000
```

### 6.2 템플릿 렌더링 오류

```
jinja2.exceptions.TemplateNotFound
```

**해결**: 패키지 재설치

```bash
cd orchay && uv pip install -e .
```

### 6.3 HTMX 요청 실패

브라우저 개발자 도구에서 Network 탭 확인:

| 상태 코드 | 원인 | 해결 |
|----------|------|------|
| 404 | 엔드포인트 없음 | 서버 라우트 확인 |
| 500 | 서버 오류 | 서버 로그 확인 |
| CORS | 도메인 불일치 | 동일 호스트 사용 |

---

## 7. 참고 자료

### 7.1 관련 문서

| 문서 | 경로 |
|------|------|
| 설계 문서 | `010-design.md` |
| 추적 매트릭스 | `025-traceability-matrix.md` |
| 테스트 명세 | `026-test-specification.md` |
| 구현 보고서 | `030-implementation.md` |

### 7.2 외부 리소스

| 리소스 | URL |
|--------|-----|
| HTMX 문서 | https://htmx.org/docs/ |
| Tailwind CSS | https://tailwindcss.com/docs |
| Jinja2 | https://jinja.palletsprojects.com/ |

### 7.3 템플릿 파일 위치

```
orchay/src/orchay/web/templates/
├── base.html          # 기본 레이아웃 (CDN, 다크테마)
├── index.html         # 메인 페이지 (2열 레이아웃)
└── partials/
    ├── tree.html      # WBS 트리 (TSK-02-02)
    ├── detail.html    # Task 상세 (TSK-03-01)
    ├── workers.html   # Worker 상태 (TSK-03-02)
    └── error.html     # 에러 메시지
```

---

## 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2025-12-28 | Claude | 최초 작성 |

---

<!--
TSK-01-02 - Jinja2 템플릿 기본 구조 사용자 매뉴얼
Version: 1.0
-->
